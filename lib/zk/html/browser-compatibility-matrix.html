<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Browser Compatibility Matrix for Zero-Knowledge Proofs</title>
    <style>
        body {
            font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
            line-height: 1.6;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            color: #333;
        }
        h1, h2 {
            color: #2c3e50;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            font-size: 14px;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 12px;
            text-align: center;
        }
        th {
            background-color: #f8f9fa;
            font-weight: 600;
        }
        tr:nth-child(even) {
            background-color: #f8f9fa;
        }
        .supported {
            color: #2ecc71;
            font-weight: bold;
        }
        .partial {
            color: #f39c12;
            font-weight: bold;
        }
        .unsupported {
            color: #e74c3c;
        }
        .footnote {
            font-size: 12px;
            color: #7f8c8d;
            margin-top: 30px;
        }
        .version {
            font-size: 12px;
            color: #7f8c8d;
        }
        .feature-name {
            text-align: left;
            font-weight: 600;
        }
        .feature-description {
            font-size: 12px;
            color: #7f8c8d;
            font-weight: normal;
        }
        .issue {
            background-color: #fff3cd;
        }
        .warning-icon {
            color: #f39c12;
            font-weight: bold;
        }
        .known-issues {
            margin-top: 40px;
            padding: 15px;
            background-color: #f8f9fa;
            border-radius: 5px;
        }
        .adaptive-paths {
            margin-top: 40px;
        }
        .path-card {
            border: 1px solid #ddd;
            border-radius: 5px;
            padding: 15px;
            margin-bottom: 15px;
        }
        .path-title {
            font-weight: bold;
            margin-bottom: 10px;
        }
        .requirements {
            font-size: 13px;
            margin-bottom: 10px;
        }
        .device-classes {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            margin: 30px 0;
        }
        .device-class {
            flex: 1;
            min-width: 200px;
            padding: 15px;
            border-radius: 5px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        .high {
            background-color: #d4edda;
            border-left: 5px solid #2ecc71;
        }
        .medium {
            background-color: #fff3cd;
            border-left: 5px solid #f39c12;
        }
        .low {
            background-color: #f8d7da;
            border-left: 5px solid #e74c3c;
        }
        .incompatible {
            background-color: #ececec;
            border-left: 5px solid #95a5a6;
        }
    </style>
</head>
<body>
    <h1>Browser Compatibility Matrix for Zero-Knowledge Proofs</h1>
    <p>
        This matrix provides information about browser support for various features needed for client-side zero-knowledge proof generation and verification.
        The system will automatically adapt to the available features on the user's device.
    </p>

    <h2>Minimum Browser Versions</h2>
    <p>These are the minimum browser versions required for full compatibility with all ZK operations:</p>
    <table>
        <thead>
            <tr>
                <th>Browser</th>
                <th>Minimum Version</th>
                <th>Notes</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>Chrome</td>
                <td>67+</td>
                <td>Full support for all features</td>
            </tr>
            <tr>
                <td>Firefox</td>
                <td>63+</td>
                <td>SharedArrayBuffer requires v79+</td>
            </tr>
            <tr>
                <td>Safari</td>
                <td>14+</td>
                <td>Limited WebAssembly memory in older versions</td>
            </tr>
            <tr>
                <td>Edge (Chromium)</td>
                <td>79+</td>
                <td>Full support</td>
            </tr>
            <tr>
                <td>Opera</td>
                <td>54+</td>
                <td>Full support</td>
            </tr>
            <tr>
                <td>Samsung Internet</td>
                <td>9+</td>
                <td>Mobile performance may be limited</td>
            </tr>
            <tr>
                <td>Internet Explorer</td>
                <td class="unsupported">Not Supported</td>
                <td>Missing critical features</td>
            </tr>
        </tbody>
    </table>

    <h2>Feature Support by Browser</h2>
    <table>
        <thead>
            <tr>
                <th>Feature</th>
                <th>Chrome</th>
                <th>Firefox</th>
                <th>Safari</th>
                <th>Edge</th>
                <th>Opera</th>
                <th>Samsung Internet</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td class="feature-name">WebAssembly<br><span class="feature-description">Required for client-side proof generation</span></td>
                <td class="supported">✓ 57+</td>
                <td class="supported">✓ 52+</td>
                <td class="supported">✓ 11+</td>
                <td class="supported">✓ 16+</td>
                <td class="supported">✓ 44+</td>
                <td class="supported">✓ 7.0+</td>
            </tr>
            <tr>
                <td class="feature-name">Web Crypto API<br><span class="feature-description">Required for cryptographic operations</span></td>
                <td class="supported">✓ 37+</td>
                <td class="supported">✓ 34+</td>
                <td class="supported">✓ 11+</td>
                <td class="supported">✓ 12+</td>
                <td class="supported">✓ 24+</td>
                <td class="supported">✓ 4.0+</td>
            </tr>
            <tr>
                <td class="feature-name">Web Workers<br><span class="feature-description">Used for offloading heavy computation</span></td>
                <td class="supported">✓ 4+</td>
                <td class="supported">✓ 3.5+</td>
                <td class="supported">✓ 4+</td>
                <td class="supported">✓ 12+</td>
                <td class="supported">✓ 10.6+</td>
                <td class="supported">✓ 1.0+</td>
            </tr>
            <tr class="issue">
                <td class="feature-name">SharedArrayBuffer<br><span class="feature-description">Used for parallel processing</span></td>
                <td class="partial">✓ 68+<span class="warning-icon">*</span></td>
                <td class="partial">✓ 79+<span class="warning-icon">*</span></td>
                <td class="partial">✓ 15+<span class="warning-icon">*</span></td>
                <td class="partial">✓ 79+<span class="warning-icon">*</span></td>
                <td class="partial">✓ 55+<span class="warning-icon">*</span></td>
                <td class="partial">✓ 10.1+<span class="warning-icon">*</span></td>
            </tr>
            <tr>
                <td class="feature-name">IndexedDB<br><span class="feature-description">Used for large data storage</span></td>
                <td class="supported">✓ 24+</td>
                <td class="supported">✓ 16+</td>
                <td class="partial">✓ 10+<span class="warning-icon">*</span></td>
                <td class="supported">✓ 12+</td>
                <td class="supported">✓ 15+</td>
                <td class="supported">✓ 4.0+</td>
            </tr>
            <tr>
                <td class="feature-name">BigInt Support<br><span class="feature-description">Required for handling large integers</span></td>
                <td class="supported">✓ 67+</td>
                <td class="supported">✓ 68+</td>
                <td class="supported">✓ 14+</td>
                <td class="supported">✓ 79+</td>
                <td class="supported">✓ 54+</td>
                <td class="supported">✓ 9.0+</td>
            </tr>
        </tbody>
    </table>
    <p class="footnote"><span class="warning-icon">*</span> Requires specific conditions or has limitations. See Known Issues section below.</p>

    <div class="known-issues">
        <h2>Known Issues and Workarounds</h2>
        <ul>
            <li><strong>SharedArrayBuffer:</strong> Requires cross-origin isolation in Chrome 87+, Firefox 79+, and Safari 15+. Pages need to set headers:<br>
                <code>Cross-Origin-Opener-Policy: same-origin</code><br>
                <code>Cross-Origin-Embedder-Policy: require-corp</code>
            </li>
            <li><strong>Safari IndexedDB:</strong> Unreliable in private browsing mode in Safari &lt; 14. Fallback to server-side computation in this case.</li>
            <li><strong>Mobile Devices:</strong> Limited available memory on mobile devices may require progressive loading and server-side computation for complex operations.</li>
            <li><strong>Safari WebAssembly:</strong> Safari &lt; 15.4 has limited memory for WebAssembly instances. Use smaller circuit chunks and process sequentially.</li>
            <li><strong>Firefox Web Crypto:</strong> Firefox 60-68 has performance issues with large keys. Use smaller key sizes or batch operations.</li>
        </ul>
    </div>

    <h2>Device Classification</h2>
    <p>The system classifies user devices into these categories to determine the optimal execution path:</p>
    
    <div class="device-classes">
        <div class="device-class high">
            <h3>High-End Devices</h3>
            <p><strong>Features:</strong> All required features, 8GB+ memory, 4+ CPU cores</p>
            <p><strong>Execution:</strong> Full client-side execution with all optimizations</p>
            <p><strong>Example:</strong> Desktop computers, high-end laptops, flagship mobile devices</p>
        </div>
        <div class="device-class medium">
            <h3>Medium Devices</h3>
            <p><strong>Features:</strong> All required features, 4-8GB memory, 2-4 CPU cores</p>
            <p><strong>Execution:</strong> Web Worker offloading or progressive loading</p>
            <p><strong>Example:</strong> Mid-range laptops, tablets, mid-range smartphones</p>
        </div>
        <div class="device-class low">
            <h3>Low-End Devices</h3>
            <p><strong>Features:</strong> Basic required features, &lt;4GB memory, &lt;2 CPU cores</p>
            <p><strong>Execution:</strong> Hybrid client/server approach</p>
            <p><strong>Example:</strong> Budget smartphones, older devices</p>
        </div>
        <div class="device-class incompatible">
            <h3>Incompatible Devices</h3>
            <p><strong>Features:</strong> Missing WebAssembly or Web Crypto support</p>
            <p><strong>Execution:</strong> Full server-side fallback</p>
            <p><strong>Example:</strong> Internet Explorer, very old browsers</p>
        </div>
    </div>

    <div class="adaptive-paths">
        <h2>Adaptive Execution Paths</h2>
        <p>The system will automatically select the most appropriate execution path based on the device's capabilities:</p>
        
        <div class="path-card">
            <div class="path-title">1. Full Client-Side Execution</div>
            <div class="requirements"><strong>Requirements:</strong> WebAssembly, Web Crypto, Web Workers, SharedArrayBuffer, 8GB+ memory</div>
            <p>All proof generation and verification happens locally on the client with maximum performance optimizations.</p>
        </div>
        
        <div class="path-card">
            <div class="path-title">2. Web Worker Offloading</div>
            <div class="requirements"><strong>Requirements:</strong> WebAssembly, Web Crypto, Web Workers, 4GB+ memory</div>
            <p>Heavy computations are offloaded to Web Workers for parallel processing while keeping the main thread responsive.</p>
        </div>
        
        <div class="path-card">
            <div class="path-title">3. Progressive Loading</div>
            <div class="requirements"><strong>Requirements:</strong> WebAssembly, Web Crypto, 4GB+ memory</div>
            <p>Circuit components and data are loaded and processed in smaller chunks to accommodate memory constraints.</p>
        </div>
        
        <div class="path-card">
            <div class="path-title">4. Hybrid Client/Server Approach</div>
            <div class="requirements"><strong>Requirements:</strong> WebAssembly, Web Crypto, any memory</div>
            <p>Simple operations are performed client-side, while complex operations are offloaded to the server.</p>
        </div>
        
        <div class="path-card">
            <div class="path-title">5. Full Server-Side Fallback</div>
            <div class="requirements"><strong>Requirements:</strong> Basic browser functionality</div>
            <p>All proof generation and verification happens on the server when client-side execution is not possible.</p>
        </div>
    </div>

    <footer class="footnote">
        <p>This compatibility matrix is based on browser support as of April 2025. The system includes automatic feature detection and will adapt to the capabilities of the user's device.</p>
        <p>Last updated: April 5, 2025</p>
    </footer>

    <script type="module">
        // This script will dynamically test the browser's capabilities when viewed in a browser
        import browserCompatibility from './browserCompatibility.js';
        
        document.addEventListener('DOMContentLoaded', () => {
            try {
                // Only run if the browser compatibility module is available
                if (typeof browserCompatibility !== 'undefined' && browserCompatibility.detectFeatures) {
                    const capabilities = browserCompatibility.detectFeatures();
                    
                    // Add a section at the top showing the current browser's capabilities
                    const headerSection = document.querySelector('h1');
                    const currentBrowserInfo = document.createElement('div');
                    currentBrowserInfo.style.padding = '15px';
                    currentBrowserInfo.style.marginTop = '20px';
                    currentBrowserInfo.style.backgroundColor = '#f8f9fa';
                    currentBrowserInfo.style.borderRadius = '5px';
                    currentBrowserInfo.style.border = '1px solid #ddd';
                    
                    currentBrowserInfo.innerHTML = `
                        <h3>Your Browser Capabilities</h3>
                        <p><strong>Browser:</strong> ${capabilities.browser.name} ${capabilities.browser.version}</p>
                        <p><strong>Compatibility Level:</strong> ${capabilities.compatibility.level}</p>
                        <p><strong>Recommended Execution Path:</strong> ${capabilities.compatibility.recommendedPath}</p>
                        <p><strong>Overall Score:</strong> ${Math.round(capabilities.performance.overall)}%</p>
                    `;
                    
                    headerSection.after(currentBrowserInfo);
                }
            } catch (error) {
                console.warn('Browser compatibility detection failed:', error);
            }
        });
    </script>
</body>
</html>