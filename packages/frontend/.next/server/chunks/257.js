"use strict";exports.id=257,exports.ids=[257],exports.modules={6835:(e,t)=>{Object.defineProperty(t,"l",{enumerable:!0,get:function(){return function e(t,r){return r in t?t[r]:"then"in t&&"function"==typeof t.then?t.then(t=>e(t,r)):"function"==typeof t&&"default"===r?t:void 0}}})},1631:(e,t)=>{var r;Object.defineProperty(t,"x",{enumerable:!0,get:function(){return r}}),function(e){e.PAGES="PAGES",e.PAGES_API="PAGES_API",e.APP_PAGE="APP_PAGE",e.APP_ROUTE="APP_ROUTE"}(r||(r={}))},9150:(e,t,r)=>{e.exports=r(145)},7041:(e,t,r)=>{r.d(t,{t:()=>i});let i={sanitizeInput:function(e){return function e(t){if("string"==typeof t)return t.replace(/[<>]/g,"").trim();if(Array.isArray(t))return t.map(e);if(t&&"object"==typeof t){let r={};for(let[i,s]of Object.entries(t))r[i]=e(s);return r}return t}(JSON.parse(JSON.stringify(e)))},validateProofInput:function(e){let t=[];if(!e||"object"!=typeof e||Array.isArray(e))return t.push({field:"input",message:"Input must be an object"}),{valid:!1,errors:t};let r=void 0!==e.proofType?Number(e.proofType):void 0;(void 0===r||isNaN(r)||r<0||r>2)&&t.push({field:"proofType",message:"Invalid proof type, must be 0, 1, or 2"});let i={0:["walletAddress","amount"],1:["walletAddress","amount","threshold"],2:["walletAddress","amount","maximum"]};if(void 0!==r&&i[r])for(let s of i[r])void 0===e[s]&&t.push({field:s,message:`Missing required field: ${s}`});if(void 0===e.walletAddress||("string"!=typeof e.walletAddress?t.push({field:"walletAddress",message:"Wallet address must be a string"}):/^(0x[a-fA-F0-9]{40}|[1-9A-HJ-NP-Za-km-z]{32,44})$/.test(e.walletAddress)||t.push({field:"walletAddress",message:"Invalid wallet address format"})),void 0!==e.amount){let r=Number(e.amount);(isNaN(r)||r<0)&&t.push({field:"amount",message:"Amount must be a non-negative number or numeric string"})}if(void 0!==e.threshold&&1===r){let r=Number(e.threshold);(isNaN(r)||r<0)&&t.push({field:"threshold",message:"Threshold must be a non-negative number or numeric string"})}if(void 0!==e.maximum&&2===r){let r=Number(e.maximum);(isNaN(r)||r<0)&&t.push({field:"maximum",message:"Maximum must be a non-negative number or numeric string"})}return{valid:0===t.length,errors:t}}}},8700:(e,t,r)=>{r.d(t,{I:()=>n});let i=new Set,s=new Map;"undefined"!=typeof setInterval&&setInterval(()=>{let e=Date.now();for(let[t,r]of s.entries())e>r&&(i.delete(t),s.delete(t))},36e5);let n={generateNonce:function(){return`${Date.now()}_${Math.random().toString(36).substring(2,15)}`},validateNonce:function(e,t,r){if("string"!=typeof e)return{valid:!1,message:"Invalid nonce format",reason:"FORMAT_ERROR"};if(!e.trim())return{valid:!1,message:"Nonce cannot be empty",reason:"EMPTY_NONCE"};let n=`${t}:${e}`;if(i.has(n))return{valid:!1,message:"Nonce has already been used",reason:"REPLAY_ATTACK"};if(r){let e=Date.now(),t=Number(r);if(isNaN(t))return{valid:!1,message:"Invalid timestamp format",reason:"TIMESTAMP_FORMAT_ERROR"};if(e-t>3e5)return{valid:!1,message:"Nonce is expired",reason:"EXPIRED_NONCE"};if(t>e+6e4)return{valid:!1,message:"Nonce timestamp is in the future",reason:"FUTURE_NONCE"}}return i.add(n),s.set(n,Date.now()+864e5),{valid:!0,message:"Nonce is valid"}}}},2030:(e,t,r)=>{r.d(t,{Y:()=>i});let i={verifyClientSignature:function(e,t){try{if(!t||!t.signature)return{valid:!1,message:"Missing signature",reason:"MISSING_SIGNATURE"};if(!t.timestamp)return{valid:!1,message:"Missing timestamp",reason:"MISSING_TIMESTAMP"};if(!t.clientId)return{valid:!1,message:"Missing client ID",reason:"MISSING_CLIENT_ID"};let e=Date.now(),r=Number(t.timestamp);if(isNaN(r))return{valid:!1,message:"Invalid timestamp format",reason:"TIMESTAMP_FORMAT_ERROR"};if(e-r>9e5)return{valid:!1,message:"Signature is expired",reason:"EXPIRED_SIGNATURE"};if(r>e+6e4)return{valid:!1,message:"Signature timestamp is in the future",reason:"FUTURE_SIGNATURE"};return{valid:!0,message:"Signature is valid"}}catch(e){return console.error("Error verifying signature:",e),{valid:!1,message:"Error verifying signature",reason:"VERIFICATION_ERROR",error:e.message}}}}},2894:(e,t,r)=>{r.d(t,{s:()=>o});var i=r(4770);let s="sha256",n=null;function a(e,t=s){if(!n)throw Error("Response signer not initialized: call initialize() with a secret key first");if(!e)throw Error("Cannot sign empty data");try{let r=JSON.stringify(e),s=(0,i.createHmac)(t,n);return s.update(r),`${t}:${s.digest("hex")}`}catch(e){throw Error(`Failed to generate signature: ${e.message}`)}}let o={initialize:function(e){if(!e||"string"!=typeof e||e.length<32)throw Error("Invalid secret key: must be a string of at least 32 characters");n=e},signResponse:function(e,t={}){if(!n)throw Error("Response signer not initialized: call initialize() with a secret key first");if(!e||"object"!=typeof e)throw Error("Invalid response data: must be an object");try{let r=JSON.parse(JSON.stringify(e));r._security={timestamp:Date.now(),expires:t.expireInSeconds?Date.now()+1e3*t.expireInSeconds:null,algorithm:t.algorithm||s,version:"1.0"};let{_security:i}=r,n=a({...r,_security:{...i,signature:void 0}},i.algorithm);return r._security.signature=n,r}catch(t){let e=Error(`Failed to sign response: ${t.message}`);throw e.originalError=t,e}},verifySignedResponse:function(e){if(!n)throw Error("Response signer not initialized: call initialize() with a secret key first");try{if(!e||!e._security)return{valid:!1,message:"Missing security metadata",reason:"MISSING_SECURITY_METADATA"};let{_security:t}=e;if(!t.signature)return{valid:!1,message:"Missing signature",reason:"MISSING_SIGNATURE"};if(!t.timestamp)return{valid:!1,message:"Missing timestamp",reason:"MISSING_TIMESTAMP"};let r=t.signature,n=JSON.parse(JSON.stringify(e));n._security={...n._security,signature:void 0};let o=a(n,t.algorithm||s),u=Buffer.from(r.split(":")[1],"hex"),l=Buffer.from(o.split(":")[1],"hex");if(u.length!==l.length||!(0,i.timingSafeEqual)(u,l))return{valid:!1,message:"Invalid signature",reason:"INVALID_SIGNATURE"};if(t.expires&&Date.now()>t.expires)return{valid:!1,message:"Response has expired",reason:"EXPIRED_RESPONSE",expiryTime:new Date(t.expires).toISOString()};let m=Date.now(),d=Number(t.timestamp);if(m-d>9e5)return{valid:!1,message:"Response is too old",reason:"STALE_RESPONSE",timestamp:new Date(d).toISOString()};if(d>m+6e4)return{valid:!1,message:"Response timestamp is in the future",reason:"FUTURE_RESPONSE",timestamp:new Date(d).toISOString()};let{_security:f,...h}=e;return{valid:!0,message:"Signature is valid",data:h,metadata:t}}catch(t){let e=Error(`Error verifying signature: ${t.message}`);throw e.originalError=t,e}},_generateSignature:a}},4673:(e,t,r)=>{r.d(t,{s:()=>u});let i=!1,s=null;async function n(e={}){let t=e.serverSide||!1,n=e.maxRetries||3;if(i&&s)return!0;let a=0;for(;a<n;)try{if(t)try{s=require("snarkjs")}catch(e){throw Error(`Failed to load snarkjs with require: ${e.message}`)}else try{s=await Promise.resolve().then(r.bind(r,4637))}catch(e){throw Error(`Failed to load snarkjs with dynamic import: ${e.message}`)}if(!s||!s.groth16||"function"!=typeof s.groth16.fullProve)throw Error("Loaded snarkjs does not contain expected methods (groth16.fullProve)");if(!s.groth16.verify||"function"!=typeof s.groth16.verify)throw Error("Loaded snarkjs does not contain expected methods (groth16.verify)");return i=!0,console.log("snarkjs loaded successfully"),!0}catch(e){console.error(`Error initializing snarkjs (attempt ${a+1}/${n}):`,e),a++,await new Promise(e=>setTimeout(e,1e3))}let o=Error(`Failed to initialize snarkjs after ${n} attempts`);throw console.error(o),o}function a(){if(!i||!s)throw Error("snarkjs not initialized. Call initialize() first.");return s}async function o(){return i||await n({serverSide:!0}),a()}let u={initialize:n,isInitialized:function(){return i&&null!==s},getSnarkjs:a,fullProve:async function(e,t,r,n={}){if(!i||!s)throw Error("snarkjs not initialized. Call initialize() first.");if(!e)throw Error("Missing required parameter: input");if(!t)throw Error("Missing required parameter: wasmPath");if(!r)throw Error("Missing required parameter: zkeyPath");try{if("undefined"!=typeof require){let e=require("fs");if(!e.existsSync(t))throw Error(`WASM file not found: ${t}`);if(!e.existsSync(r))throw Error(`zkey file not found: ${r}`)}let i=await s.groth16.fullProve(e,t,r,n);if(!i||!i.proof||!i.publicSignals)throw Error("Proof generation did not return expected results");return i}catch(s){let i=Error(`Failed to generate proof: ${s.message}`);throw i.originalError=s,i.input=e,i.wasmPath=t,i.zkeyPath=r,i}},verify:async function(e,t,r){if(!i||!s)throw Error("snarkjs not initialized. Call initialize() first.");if(!e)throw Error("Missing required parameter: verificationKey");if(!t)throw Error("Missing required parameter: publicSignals");if(!r)throw Error("Missing required parameter: proof");try{return await s.groth16.verify(e,t,r)}catch(t){let e=Error(`Failed to verify proof: ${t.message}`);throw e.originalError=t,e}},load:o}},5966:(e,t,r)=>{r.d(t,{X:()=>o});let i={enabled:!1,endpoint:null,bufferSize:10,flushInterval:3e4,retryAttempts:3},s=[],n=null;async function a(){if(0===s.length)return;if(!i.enabled||!i.endpoint){s.length=0;return}let e=[...s];s.length=0;let t=0,r=!1;for(;t<i.retryAttempts&&!r;)try{let t=await fetch(i.endpoint,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({events:e,timestamp:new Date().toISOString(),version:"0.1.0"})});if(!t.ok)throw Error(`Server returned status: ${t.status}`);r=!0}catch(e){console.error(`Failed to send telemetry data (attempt ${t+1}/${i.retryAttempts}):`,e),++t<i.retryAttempts?await new Promise(e=>setTimeout(e,1e3*Math.pow(2,t))):console.error("Failed to send telemetry data after maximum retry attempts")}}let o={initialize:function(e={}){if((i={...i,...e}).enabled&&i.endpoint)return n&&clearInterval(n),n=setInterval(a,i.flushInterval),!0;throw Error("Telemetry initialization failed: telemetry is disabled or endpoint is not configured")},recordOperation:function(e){if(!e||"object"!=typeof e)throw Error("Invalid operation data: must be an object");if(!e.operation)throw Error("Invalid operation data: operation name is required");if(void 0===e.executionTimeMs||isNaN(e.executionTimeMs))throw Error("Invalid operation data: executionTimeMs must be a number");if(!i.enabled){console.warn("Telemetry is disabled, operation not recorded:",e.operation);return}if(!i.endpoint)throw Error("Telemetry endpoint not configured");try{s.push({type:"operation",timestamp:new Date().toISOString(),operation:e.operation,executionTimeMs:e.executionTimeMs,serverSide:!!e.serverSide,success:!!e.success,additionalInfo:e.additionalInfo||{}}),s.length>=i.bufferSize&&a()}catch(r){let t=Error(`Failed to record operation: ${r.message}`);throw t.originalError=r,t.operationData=e,t}},recordError:function(e,t,r={}){if(!e)throw Error("Invalid error data: context is required");if(!t)throw Error("Invalid error data: errorMessage is required");if(r&&"object"!=typeof r)throw Error("Invalid error data: additionalInfo must be an object");if(!i.enabled){console.error(`[Telemetry disabled] Error in ${e}: ${t}`,r);return}if(!i.endpoint)throw Error("Telemetry endpoint not configured");try{s.push({type:"error",timestamp:new Date().toISOString(),context:e,errorMessage:t,additionalInfo:r||{}}),a()}catch(i){console.error("Failed to record error in telemetry system:",i),console.error("Original error:",e,t,r)}},_getConfig:()=>({...i}),_getBufferLength:()=>s.length,_flushBuffer:a}},5079:(e,t,r)=>{r.d(t,{p:()=>i});class i{constructor(e={}){if(this.userRequests={},this.defaultLimits=e.defaultLimits||{maxRequestsPerMinute:10,maxRequestsPerHour:100},this.defaultLimits.maxRequestsPerMinute<=0||!Number.isInteger(this.defaultLimits.maxRequestsPerMinute))throw Error("Invalid maxRequestsPerMinute: must be a positive integer");if(this.defaultLimits.maxRequestsPerHour<=0||!Number.isInteger(this.defaultLimits.maxRequestsPerHour))throw Error("Invalid maxRequestsPerHour: must be a positive integer");let t=e.cleanupIntervalMs||36e5;"undefined"!=typeof setInterval&&(this.cleanupInterval=setInterval(()=>this.cleanup(),t))}setUserLimits(e,t){if(!e||"string"!=typeof e)throw Error("Invalid userId: must be a non-empty string");if(!t||"object"!=typeof t)throw Error("Invalid limits: must be an object");if(void 0!==t.maxRequestsPerMinute&&(t.maxRequestsPerMinute<=0||!Number.isInteger(t.maxRequestsPerMinute)))throw Error("Invalid maxRequestsPerMinute: must be a positive integer");if(void 0!==t.maxRequestsPerHour&&(t.maxRequestsPerHour<=0||!Number.isInteger(t.maxRequestsPerHour)))throw Error("Invalid maxRequestsPerHour: must be a positive integer");this.userRequests[e]||(this.userRequests[e]={minuteRequests:[],hourRequests:[],limits:{...this.defaultLimits}}),this.userRequests[e].limits={...this.defaultLimits,...t}}checkRateLimit(e){if(!e||"string"!=typeof e)throw Error("Invalid userId: must be a non-empty string");this.userRequests[e]||(this.userRequests[e]={minuteRequests:[],hourRequests:[],limits:{...this.defaultLimits}});let t=Date.now(),r=this.userRequests[e];r.minuteRequests=r.minuteRequests.filter(e=>t-e<6e4),r.hourRequests=r.hourRequests.filter(e=>t-e<36e5);let i={current:r.minuteRequests.length,max:r.limits.maxRequestsPerMinute,remaining:r.limits.maxRequestsPerMinute-r.minuteRequests.length,reset:t+6e4-t%6e4},s={current:r.hourRequests.length,max:r.limits.maxRequestsPerHour,remaining:r.limits.maxRequestsPerHour-r.hourRequests.length,reset:t+36e5-t%36e5},n=i.current<i.max&&s.current<s.max;return n&&(r.minuteRequests.push(t),r.hourRequests.push(t)),{allowed:n,minuteLimit:i,hourLimit:s,userId:e}}releaseRequest(e){if(!e||"string"!=typeof e)throw Error("Invalid userId: must be a non-empty string");if(!this.userRequests[e])return!1;let t=this.userRequests[e],r=!1;return t.minuteRequests.length>0&&(t.minuteRequests.pop(),r=!0),t.hourRequests.length>0&&(t.hourRequests.pop(),r=!0),r}cleanup(){let e=Date.now()-864e5,t=0;for(let r in this.userRequests){let i=this.userRequests[r];Math.max(...i.hourRequests.concat(i.minuteRequests,0))<e&&(delete this.userRequests[r],t++)}return t}getStatus(){return{userCount:Object.keys(this.userRequests).length,defaultLimits:{...this.defaultLimits},totalRequests:Object.values(this.userRequests).reduce((e,t)=>e+t.hourRequests.length,0)}}destroy(){this.cleanupInterval&&(clearInterval(this.cleanupInterval),this.cleanupInterval=null)}}}};